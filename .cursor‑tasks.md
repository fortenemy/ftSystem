# .cursor-tasks.md

---

## Step 1

- [x] 1. **Virtual Environment Setup** - Activated Python virtual environment in project root.
- [x] 2. **Project Structure Initialization** - Created `src/`, `tests/`, and `docs/` directories; added `__init__.py`.
- [x] 3. **Dependencies Configuration** - Added `requirements.txt` with `typer`, `pydantic`, `langchain` and installed them.

---

## Step 2

- [x] 1. **CLI Skeleton** - Created `src/main.py` with Typer commands `run` and `list-agents`.
- [x] 2. **Agent Base Interface** - Added `src/agents/base.py` containing `Agent` abstract class and `AgentConfig` (Pydantic).
- [x] 3. **Hello Demo Agent** - Implemented `src/agents/hello_agent.py` and registered it in `AGENT_REGISTRY`.

---

## Step 3

- [x] 1. **Automatic Agent Discovery** - Dynamic agent discovery in `agents/__init__.py` auto-registers all `Agent` subclasses in `AGENT_REGISTRY`.
- [x] 2. **Agent Configuration Loading** - CLI `--config` option for JSON/YAML configs with Pydantic validation.
- [x] 3. **Basic Test Suite (pytest)** - `tests/test_agents.py` verifies listing and `HelloAgent.run()`; CI workflow added.

---

## Step 4

- [x] 1. **Standardize Agent Output** - `Agent.run()` returns serializable values; updated HelloAgent.
- [x] 2. **JSON File Output** - `run --output <path>` saves results to JSON.
- [x] 3. **Output Tests** - Extended tests to validate return value and file output.

---

## Step 5

- [x] 1. **Global Logging + --log-level** - Added global log config; migrated prints to `logging`; tests.
- [x] 2. **Extended Agent Registry** - Subpackage discovery with import error capture.
- [x] 3. **RunResult & BaseModel JSON** - Serialize Pydantic via `.model_dump()` under `--output`.

---

## Step 6

- [x] 1. **Verbose/Error Listing** - `list-agents --verbose/--show-errors` with docstrings and import diagnostics.
- [x] 2. **New-Agent Generator** - `new-agent` with target dir and optional config JSON output.
- [x] 3. **Generator Tests** - Cover discovery, errors, and generator.

---

## Step 7

- [x] 1. **README: New CLI Features** - Documented logging flags, verbose listing, import errors, new-agent usage.
- [x] 2. **YAML Config Support** - Added `.yaml/.yml` loading; tests.
- [x] 3. **Agent Autocompletion** - Typer autocompletion for `--agent` from `AGENT_REGISTRY`; test.

---

## Step 8

- [x] 1. **CI Coverage & Threshold** - Coverage report; fail under 85%; badge.
- [x] 2. **PyProject Packaging & CLI** - `console_scripts` entry in `pyproject.toml`.
- [x] 3. **Ruff/Black/Mypy Pre-Commit** - Linters/formatters and hooks configured.

---

## Step 9

- [x] 1. **Session Memory JSONL** - `SessionSummary` persisted and `history show` added.
- [x] 2. **Async Orchestrator Skeleton** - `MasterAgent` with round-based flow; tests.
- [x] 3. **Rich Colored Logs** - Rich-based colored logs; `--no-color` flag.

---

## Step 10

- [x] 1. **Interactive Mode** - Interactive CLI keeping session context.
- [x] 2. **UTC Timezones** - `SessionSummary` uses timezone-aware UTC; tests.
- [x] 3. **MasterAgent Config** - `subagents` via YAML/JSON; validated.

---

## Step 11

- [x] 1. **Interactive: Persist Inputs** - Store user/agent turns for replay.
- [x] 2. **MasterAgent Rounds** - Configurable rounds and timeouts.
- [x] 3. **History Filters** - `history show --agent/--contains`.

---

## Step 12

- [x] 1. **Replay Session** - Pretty-print transcript replay.
- [x] 2. **Timeout Handling Tests** - Simulate MasterAgent timeouts.
- [x] 3. **Docs Update** - README examples for interactive transcripts and filters.

---

## Step 13

- [x] 1. **Config Profiles** - Layered config (env/cli/file) and simple profiles (dev/prod).
- [x] 2. **Coordinator Metrics** - Per-agent latency and success in `RunResult.metrics`.
- [x] 3. **Plugin Entry Points** - Entry points sketch and plugin docs.

---

## Step 14

- [x] 1. **Forum & Transcript** - System/user/agent messages; transcript returned with results + metrics.
- [x] 2. **Security Policy & Redaction** - Allowlist agents; cap rounds; redact secrets.
- [x] 3. **Voice S2S MVP** - STT/TTS in interactive (`/rec`) with Vosk + SAPI5.

---

## Step 15

- [x] 1. **Voice UX & VAD** - Beeps for start/stop; optional silence-timeout.
- [x] 2. **Redaction Levels** - `--redact-level strict|normal` with extended patterns; tests.
- [x] 3. **Docs Voice Guide** - README with Vosk/Piper setup and examples.

---

## Step 16

- [x] 1. **History Export/Clear** - `history export --out` (JSONL) and `history clear --yes [--all]`.
- [x] 2. **History JSON Output** - `history show --json` returns a JSON array instead of JSONL lines.

---

## Step 17

- [x] 1. **list-agents JSON** - `list-agents --format json [--verbose --show-errors]` for scripting integration.

---

## Step 18

- [x] 1. **README Update (History/Formats)** - Sections for `history export|clear` and JSON format in `list-agents`.

---

## Step 19

- [x] 1. **History Prune** - `history prune --keep N --yes` and old files removal via `--days N`.
- [x] 2. **Voice Devices** - `voice devices [--list-voices] [--json]` lists microphones and TTS voices.
- [x] 3. **Replay Output File** - `history replay --out <file.txt>` saves a formatted transcript to a file.

---

## Step 20

- [x] 1. **History Find (cross-day)** - `history find --contains <text> [--since YYYY-MM-DD|--days N] [--agent] [--json]` for multi-day search.
- [x] 2. **History Stats** - `history stats [--since YYYY-MM-DD|--days N] [--json]` to summarize entries per agent and status.
- [x] 3. **Security Redact CLI** - `security redact --in <file> --out <file> [--level strict|normal]` to test/apply redaction.

---

## Step 21

- [x] 1. **History Range & Sort** - Add `--limit` and `--reverse` to `history find` for paging and newest-first.
- [x] 2. **Voice Profiles** - `voice profile set/show` for defaults (`voice_lang`, `mic_index`, `beep`).
- [x] 3. **Session Tags** - Support `--tag <name>` on `run|interactive` and filtering by `--tag` in history.

---

## Step 22

- [x] 1. **History Pagination** - Add `--offset` to `history find` and output `{total, items}` in JSON.
- [x] 2. **Interactive UX** - Add `/last` to show last agent response and `/tags` to show active tags.
- [x] 3. **Security Patterns+** - Extend strict redaction (IBAN/PESEL) with tests; keep normal conservative.

---

## Step 23

- [x] 1. **History Find offset docs** - Expand README examples with --offset cases.
- [x] 2. **Interactive Enhancements** - Optional /clear to wipe screen (non-essential), with tests.
- [x] 3. **Security Patterns Review** - Added NIP redaction (strict), tests updated.

---

## Step 24

- [x] 1. **History Export Filters** - Add `--tag` filter to `history export`.
- [x] 2. **Interactive Save** - Add `/save <file>` to save last reply to a file.
- [x] 3. **Voice Testability** - Add `--dry-run-tts` flag to interactive to log TTS text instead of speaking.

---

## Step 25

- [x] 1. **Functionality and logic review** - Check CLI, agents, registry, commands, logging, and error cases.
- [x] 2. **Code quality and structure analysis** - Review readability, modularity, naming, duplication, standards.
- [x] 3. **Security assessment** - Review input handling, validation, redaction, config and secret management.

---

## Step 26

- [x] 1. **Comprehensive Docstrings** - Added complete docstrings to all public methods (agents/core/CLI helpers).
- [x] 2. **Type Hints Completion** - Completed type annotations in helper functions and CLI signatures.
- [x] 3. **Enhanced Error Messages** - Enriched with exception type and context (file paths, agent names) without secret leakage.
- [x] 4. **Documentation Update** - Updated README (Developer Guide) and Code Review section (status "Done").

---

## Step 27

- [x] 1. **Debug Logging** - Added additional logging in critical paths (`MasterAgent.run`, `_build_agent_config`, CLI run).
- [x] 2. **Orchestration Tests** - Expanded coverage for security policies and subagent error handling.
- [x] 3. **Architecture Diagrams** - Created `docs/architecture.md` with Mermaid diagrams and linked in README.

---

## Step 28

- [x] 1. **Performance Profiling** - Added perf profile to CLI with JSON output results.
- [x] 2. **Prometheus Metrics** - Optional metrics export (--metrics-path) with tests.
- [x] 3. **CLI Internationalization** - Global --lang (en/pl) with translated error messages.

---

## Step 29

- [x] 1. **Researcher Agent** - Information gathering agent with structured findings, source tracking, and configurable max_sources parameter for fact-checking tasks.
- [x] 2. **Coder Agent** - Code generation and analysis agent supporting Python, JavaScript, Java with syntax validation and language-specific warnings.
- [x] 3. **Analyst Agent** - Data analysis agent with pattern recognition, multi-dimensional insight extraction, and confidence scoring for different analysis types.
- [x] 4. **Critic Agent** - Peer review agent with multi-dimensional quality scoring (accuracy, completeness, clarity, consistency, structure), issue detection, and approval status.
- [x] 5. **Summarizer Agent** - Multi-source synthesis agent supporting concise/detailed/executive styles with key point extraction and conclusion generation.
- [x] 6. **Comprehensive Test Suite** - 74 tests total across all 5 agents: ResearcherAgent (12), CoderAgent (15), AnalystAgent (15), CriticAgent (15), SummarizerAgent (17) with â‰¥85% code coverage.

---
